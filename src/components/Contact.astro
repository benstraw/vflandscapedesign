---
const formspreeEndpoint = import.meta.env.PUBLIC_FORMSPREE_ENDPOINT ?? 'https://formspree.io/f/xpqjjwdy';
---

<section id="contact" class="py-24 lg:py-32 px-6 bg-warm-white">
  <div class="max-w-7xl mx-auto">
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-16 lg:gap-24">
      <!-- Left: copy -->
      <div>
        <span class="font-body text-sm font-medium tracking-widest uppercase text-forest">
          Get in Touch
        </span>
        <h2 class="font-display text-4xl lg:text-5xl font-bold text-ink mt-3 mb-6 leading-tight">
          Let's Talk About<br class="hidden sm:block" /> Your Project
        </h2>
        <p class="font-body text-base text-ink/70 leading-relaxed mb-10">
          We typically respond within one business day.
        </p>

        <!-- Contact details -->
        <div class="flex flex-col gap-5">
          <div class="flex items-center gap-3">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-forest flex-shrink-0">
              <path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75" />
            </svg>
            <a
              href="mailto:matt@vflandscapedesign.com"
              class="font-body text-base text-ink hover:text-forest transition-colors"
            >
              matt@vflandscapedesign.com
            </a>
          </div>
          <div class="flex items-center gap-3">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-forest flex-shrink-0">
              <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 002.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 01-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 00-1.091-.852H4.5A2.25 2.25 0 002.25 4.5v2.25z" />
            </svg>
            <a
              href="tel:+16109303462"
              class="font-body text-base text-ink hover:text-forest transition-colors"
            >
              (610) 930-3462
            </a>
          </div>
        </div>
      </div>

      <!-- Right: form -->
      <div>
        <form
          id="contact-form"
          action={formspreeEndpoint}
          method="POST"
          class="flex flex-col gap-5"
        >
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-5">
            <div class="flex flex-col gap-1.5">
              <label for="name" class="font-body text-sm font-medium text-ink">
                Name <span class="text-forest">*</span>
              </label>
              <input
                type="text"
                id="name"
                name="name"
                required
                placeholder="Your full name"
                class="font-body text-base text-ink bg-transparent border border-ink/20 px-4 py-3 focus:outline-none focus:border-forest transition-colors placeholder:text-ink/30"
              />
            </div>
            <div class="flex flex-col gap-1.5">
              <label for="email" class="font-body text-sm font-medium text-ink">
                Email <span class="text-forest">*</span>
              </label>
              <input
                type="email"
                id="email"
                name="email"
                required
                placeholder="your@email.com"
                class="font-body text-base text-ink bg-transparent border border-ink/20 px-4 py-3 focus:outline-none focus:border-forest transition-colors placeholder:text-ink/30"
              />
            </div>
          </div>

          <div class="flex flex-col gap-1.5">
            <label for="phone" class="font-body text-sm font-medium text-ink">
              Phone <span class="text-forest">*</span>
            </label>
            <input
              type="tel"
              id="phone"
              name="phone"
              required
              placeholder="(610) 000-0000"
              class="font-body text-base text-ink bg-transparent border border-ink/20 px-4 py-3 focus:outline-none focus:border-forest transition-colors placeholder:text-ink/30"
            />
          </div>

          <div class="flex flex-col gap-1.5">
            <label for="message" class="font-body text-sm font-medium text-ink">
              Message <span class="text-forest">*</span>
            </label>
            <textarea
              id="message"
              name="message"
              required
              rows="5"
              placeholder="Tell us about your project..."
              class="font-body text-base text-ink bg-transparent border border-ink/20 px-4 py-3 focus:outline-none focus:border-forest transition-colors placeholder:text-ink/30 resize-none"
            ></textarea>
          </div>

          <!-- Submit -->
          <button
            type="submit"
            id="submit-btn"
            class="font-body font-medium text-base bg-forest text-white px-8 py-4 hover:bg-earth transition-colors duration-300 self-start disabled:opacity-60 disabled:cursor-not-allowed"
          >
            Send Message
          </button>

          <!-- Success / Error states -->
          <div id="form-success" class="hidden font-body text-sm text-forest bg-forest/10 px-4 py-3">
            Thanks! We'll be in touch within one business day.
          </div>
          <div id="form-error" class="hidden font-body text-sm text-red-700 bg-red-50 px-4 py-3">
            Something went wrong. Please email us directly at matt@vflandscapedesign.com.
          </div>
        </form>
      </div>
    </div>
  </div>
</section>

<script>
  const form = document.getElementById('contact-form') as HTMLFormElement | null;
  const submitBtn = document.getElementById('submit-btn') as HTMLButtonElement | null;
  const successMsg = document.getElementById('form-success');
  const errorMsg = document.getElementById('form-error');

  form?.addEventListener('submit', async (e) => {
    e.preventDefault();
    if (!form || !submitBtn) return;

    submitBtn.disabled = true;
    submitBtn.textContent = 'Sendingâ€¦';
    successMsg?.classList.add('hidden');
    errorMsg?.classList.add('hidden');

    try {
      const res = await fetch(form.action, {
        method: 'POST',
        body: new FormData(form),
        headers: { Accept: 'application/json' },
      });

      if (res.ok) {
        form.reset();
        successMsg?.classList.remove('hidden');
        submitBtn.textContent = 'Send Message';
        submitBtn.disabled = false;
      } else {
        throw new Error('Non-OK response');
      }
    } catch {
      errorMsg?.classList.remove('hidden');
      submitBtn.textContent = 'Send Message';
      submitBtn.disabled = false;
    }
  });
</script>
